<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="D&amp;D 5e">
<meta name="mobile-web-app-capable" content="yes">
<meta name="theme-color" content="#0a0b14">
<meta name="description" content="Scheda personaggio completa per D&amp;D 5a edizione ‚Äî razze, classi, magia, inventario, riposo">

<title>D&D 5e ‚Äî Scheda Personaggio</title>

<!-- PWA Manifest -->
<link rel="manifest" href="manifest.json">

<!-- Apple Touch Icons -->
<link rel="apple-touch-icon" href="assets/icons/icon-180.png">
<link rel="apple-touch-icon" sizes="152x152" href="assets/icons/icon-152.png">
<link rel="apple-touch-icon" sizes="180x180" href="assets/icons/icon-180.png">
<link rel="apple-touch-icon" sizes="167x167" href="assets/icons/icon-180.png">

<!-- Favicon -->
<link rel="icon" type="image/png" sizes="32x32" href="assets/icons/icon-96.png">

<!-- Stylesheet -->
<link rel="stylesheet" href="css/style.css">
</head>
<body>
<div id="saveBanner">
<div id="bannerInner">
<div id="bannerTop"><span class="bico">‚öîÔ∏è</span><span class="btitle">D&D 5e ‚Äî Aggiungi alla schermata Home</span><button class="bclose" onclick="hideBanner()">Chiudi</button></div>
<div class="bsteps">
<div class="bstep"><div class="bsn">1</div><div class="bst">Tocca <strong>Condividi ‚Üë</strong> in basso a Safari</div></div>
<div class="bstep"><div class="bsn">2</div><div class="bst">Seleziona <strong>"Aggiungi a schermata Home"</strong></div></div>
<div class="bstep"><div class="bsn">3</div><div class="bst">Premi <strong>"Aggiungi"</strong> in alto a destra</div></div>
<div class="bstep"><div class="bsn">üì§</div><div class="bst">Per condividere: <strong>AirDrop</strong> questo file HTML</div></div>
</div>
<button class="bhide" onclick="hideBanner()"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>Ho capito ‚Äî vai alla scheda</button>
</div></div>





<div id="saveBanner">
  <div id="bannerInner">
    <div id="bannerTop">
      <span class="bico">‚öîÔ∏è</span>
      <span class="btitle">D&D 5e ‚Äî Aggiungi alla schermata Home</span>
      <button class="bclose" onclick="hideBanner()">Chiudi</button>
    </div>
    <div class="bsteps">
      <div class="bstep">
        <div class="bsn">1</div>
        <div class="bst">Tocca <strong>Condividi ‚Üë</strong> in basso a Safari</div>
      </div>
      <div class="bstep">
        <div class="bsn">2</div>
        <div class="bst">Seleziona <strong>"Aggiungi a schermata Home"</strong></div>
      </div>
      <div class="bstep">
        <div class="bsn">3</div>
        <div class="bst">Premi <strong>"Aggiungi"</strong> in alto a destra</div>
      </div>
      <div class="bstep">
        <div class="bsn">üì§</div>
        <div class="bst">Per condividere: <strong>Condividi ‚Üí AirDrop</strong> questa pagina</div>
      </div>
    </div>
    <button class="bhide" onclick="hideBanner()">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
      Ho capito ‚Äî vai alla scheda
    </button>
  </div>
</div>


<div class="bg-mesh"></div>
<div class="app-header">
<div class="char-name-row">
<input class="char-name-input" id="charName" placeholder="Nome Personaggio" maxlength="50">
<button class="dice-pill" onclick="openDice()">‚öÑ Dado</button>
</div>
<div class="char-meta">
<div class="mf"><label>Classe e Livello</label><input id="hdrClass" placeholder="es. Guerriero 5"></div>
<div class="mf"><label>Background</label><input id="hdrBg" placeholder="es. Soldato"></div>
<div class="mf"><label>Giocatore</label><input id="hdrPlayer"></div>
</div>
<div class="char-meta2" style="margin-top:5px;">
<div class="mf"><label>Razza</label><input id="hdrRace" placeholder="es. Elfo"></div>
<div class="mf"><label>Allineamento</label><input id="hdrAlign"></div>
<div class="mf"><label>P.E.</label><input id="hdrXP" type="number" placeholder="0"></div>
</div>
</div>
<div class="scroll-area">
<div class="tab-pane active" id="tp1">
<div class="card">
<div class="card-title">Caratteristiche</div>
<div class="stats-grid" id="statsGrid"></div>
</div>
<div class="card">
<div class="grid3">
<div class="centered">
<div class="lbl">Bonus Comp.</div>
<select id="profBonus" onchange="updateAll()" style="background:transparent;border:none;outline:none;font-family:var(--font);font-size:26px;font-weight:800;color:var(--accent);text-align:center;width:100%;cursor:pointer;">
<option value="2">+2</option><option value="3">+3</option><option value="4">+4</option>
<option value="5">+5</option><option value="6">+6</option>
</select>
</div>
<div class="centered">
<div class="lbl">Ispirazione</div>
<div style="margin-top:8px;">
<input type="checkbox" id="inspiration" style="width:28px;height:28px;accent-color:var(--accent5);cursor:pointer;">
</div>
</div>
<div class="centered">
<div class="lbl">Perc. Passiva</div>
<div class="val-lg mt6" id="passivePerc" style="color:var(--accent3);">10</div>
</div>
</div>
<div class="sep"></div>
<div class="grid2">
<div class="centered">
<div class="lbl">Indagare Passivo</div>
<div class="val-lg mt6" id="passiveInv" style="color:var(--accent);">10</div>
</div>
<div>
<div class="lbl">Visione</div>
<input id="vision" class="input" placeholder="Normale / Scurovisione 18m">
</div>
</div>
</div>
<div class="card">
<div class="card-title">Tiri Salvezza</div>
<div id="savesContainer"></div>
</div>
<div class="card">
<div class="card-title">Sensi & Movimento</div>
<div class="grid3">
<div><div class="lbl">Velocit√† (mt)</div><input id="movSpeed" class="input" type="number" value="9" style="text-align:center;font-weight:700;font-size:16px;"></div>
<div><div class="lbl">All'ora (km)</div><input id="movHour" class="input" type="number" value="4" style="text-align:center;font-weight:700;font-size:16px;"></div>
<div><div class="lbl">Al giorno (km)</div><input id="movDay" class="input" type="number" value="35" style="text-align:center;font-weight:700;font-size:16px;"></div>
</div>
<div class="mt10"><div class="lbl">Movimento Speciale</div><input id="movSpecial" class="input mt6" placeholder="es. Volare 18m, Nuotare 9m‚Ä¶"></div>
</div>
<div class="card">
<div class="card-title">Vantaggi, Resistenze & Immunit√†</div>
<div class="tag-list" id="vantTags"></div>
<div class="tag-add-row">
<input class="tag-add-inp" id="vantInp" placeholder="Aggiungi voce‚Ä¶">
<button class="tag-add-btn" onclick="addVantTag()">+</button>
</div>
</div>
</div>
<div class="tab-pane" id="tp2">
<div class="card">
<div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:12px;">
<div class="card-title" style="margin:0;">Abilit√†</div>
<div style="font-size:10px;color:var(--text3);">‚óè Comp &nbsp; ‚óâ Maestria</div>
</div>
<div id="skillsContainer"></div>
</div>
</div>
<div class="tab-pane" id="tp3">
<div class="card">
<div class="card-title">Punti Ferita</div>
<div class="metric-row" style="margin-bottom:10px;">
<div class="metric-box metric-hp">
<div class="metric-label">PF Attuali</div>
<input class="metric-inp" id="hpCur" type="number" value="0" min="0">
<div style="font-size:11px;color:rgba(255,112,112,0.6);">/ <span id="hpMaxShow">0</span></div>
</div>
<div class="metric-box metric-plain">
<div class="metric-label">PF Massimi</div>
<input class="metric-inp" id="hpMax" type="number" value="0" min="0" oninput="document.getElementById('hpMaxShow').textContent=this.value">
<div style="font-size:11px;color:var(--text3);">Massimi</div>
</div>
<div class="metric-box" style="background:rgba(255,179,71,0.08);border:1px solid rgba(255,179,71,0.22);">
<div class="metric-label" style="color:var(--accent5);">PF Temporanei</div>
<input class="metric-inp" id="hpTemp" type="number" value="0" style="color:var(--accent5);">
</div>
</div>
<div class="grid2 mt10">
<div>
<div class="lbl">Dadi Vita Totali</div>
<input id="hdTotal" class="input" placeholder="es. 5d8" style="font-weight:700;">
</div>
<div>
<div class="lbl">Dadi Vita Usati</div>
<div style="display:flex;gap:5px;flex-wrap:wrap;margin-top:6px;" id="hdGrid"></div>
<button class="add-btn" style="margin-top:5px;padding:5px;" onclick="S.hdBoxes++;buildHdGrid()">+ dado</button>
</div>
</div>
<div class="sep"></div>
<div class="lbl" style="text-align:center;margin-bottom:8px;">Tiri vs. Morte</div>
<div style="display:flex;gap:24px;justify-content:center;">
<div class="centered">
<div style="font-size:10px;font-weight:600;color:#3cdc82;margin-bottom:6px;">Successi</div>
<div style="display:flex;gap:7px;" id="deathSucc"></div>
</div>
<div class="centered">
<div style="font-size:10px;font-weight:600;color:#ff5050;margin-bottom:6px;">Fallimenti</div>
<div style="display:flex;gap:7px;" id="deathFail"></div>
</div>
</div>
</div>
<div class="card">
<div class="grid4">
<div class="metric-box metric-accent" style="padding:12px 6px;">
<div class="metric-label">CA</div>
<input class="metric-inp" id="combAC" type="number" value="10">
</div>
<div class="metric-box metric-accent" style="padding:12px 6px;">
<div class="metric-label">Iniziativa</div>
<div class="metric-val" id="combInit" style="color:var(--accent);font-size:22px;">+0</div>
</div>
<div class="metric-box metric-accent" style="padding:12px 6px;">
<div class="metric-label">Velocit√†</div>
<div class="metric-val" id="combSpd" style="color:var(--accent3);font-size:18px;">9mt</div>
</div>
<div class="metric-box metric-plain" style="padding:12px 6px;">
<div class="metric-label">Armatura</div>
<input class="metric-inp" id="combArmor" placeholder="tipo" style="font-size:13px;color:var(--text2);">
</div>
</div>
<div class="mt10"><div class="lbl">Note Armatura / Protezioni</div><textarea id="armorNotes" class="input mt6" style="min-height:55px;" placeholder="Tipo armatura, scudo, bonus‚Ä¶"></textarea></div>
</div>
<div class="card">
<div class="card-title">Armi & Munizioni</div>
<div class="weapon-row" style="padding:0 0 6px;">
<div class="w-hdr">ARMA</div><div class="w-hdr" style="text-align:center;">ATT.</div>
<div class="w-hdr" style="text-align:center;">DANNO/TIPO</div>
<div class="w-hdr" style="text-align:center;">GIT.</div>
<div class="w-hdr" style="text-align:center;">KG</div><div></div>
</div>
<div id="weaponsContainer"></div>
<button class="add-btn" onclick="addWeapon()">+ Aggiungi Arma</button>
</div>
<div class="card">
<div class="card-title">Talenti, Privilegi & Tratti</div>
<div id="featsContainer"></div>
<button class="add-btn" onclick="addFeat()">+ Aggiungi Voce</button>
</div>
</div>
<!-- ‚ïê‚ïê TAB 4: ARMATURE & GIOIELLI ‚ïê‚ïê -->
<div class="tab-pane" id="tp4">

<div class="card">
<div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:14px;">
<div class="card-title" style="margin:0;">Classe Armatura Totale</div>
</div>
<div style="display:flex;align-items:center;justify-content:center;gap:16px;padding:16px 0;">
<div style="text-align:center;">
<div style="font-size:11px;font-weight:700;letter-spacing:.5px;text-transform:uppercase;color:var(--text3);margin-bottom:4px;">CA BASE</div>
<input id="caBase" type="number" value="10" min="0" max="30"
style="width:72px;background:var(--glass);border:1px solid var(--glass-border);border-radius:12px;
color:var(--text2);text-align:center;font-family:var(--font);font-size:22px;font-weight:800;
padding:8px;outline:none;"
oninput="recalcCA()">
</div>
<div style="font-size:28px;color:var(--text3);font-weight:300;">+</div>
<div style="text-align:center;">
<div style="font-size:11px;font-weight:700;letter-spacing:.5px;text-transform:uppercase;color:var(--text3);margin-bottom:4px;">BONUS ARMATURE</div>
<div id="caBonusArmor" style="font-size:22px;font-weight:800;color:var(--accent);min-width:52px;text-align:center;">0</div>
</div>
<div style="font-size:28px;color:var(--text3);font-weight:300;">+</div>
<div style="text-align:center;">
<div style="font-size:11px;font-weight:700;letter-spacing:.5px;text-transform:uppercase;color:var(--text3);margin-bottom:4px;">BONUS GIOIELLI</div>
<div id="caBonusJewels" style="font-size:22px;font-weight:800;color:var(--accent2);min-width:52px;text-align:center;">0</div>
</div>
<div style="font-size:28px;color:var(--text3);font-weight:300;">=</div>
<div style="text-align:center;background:rgba(108,143,255,.12);border:1px solid rgba(108,143,255,.3);border-radius:16px;padding:12px 18px;">
<div style="font-size:11px;font-weight:700;letter-spacing:.5px;text-transform:uppercase;color:var(--accent);margin-bottom:4px;">CA TOTALE</div>
<div id="caTotal" style="font-size:36px;font-weight:800;color:var(--accent);letter-spacing:-1px;">10</div>
</div>
</div>
<div style="font-size:11px;color:var(--text3);text-align:center;padding-bottom:4px;">
La CA totale viene sincronizzata automaticamente con la scheda Combattimento
</div>
</div>

<!-- ARMATURE -->
<div class="card">
<div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:14px;">
<div class="card-title" style="margin:0;">Armature & Scudi</div>
<div style="font-size:10px;color:var(--text3);">‚ú¶ penalit√† furtivit√†</div>
</div>
<!-- Header -->
<div style="display:grid;grid-template-columns:1fr 90px 52px 52px 52px 32px 26px;gap:6px;padding:0 0 8px;border-bottom:1px solid rgba(255,255,255,.06);margin-bottom:4px;">
<div style="font-size:9px;font-weight:700;letter-spacing:.5px;text-transform:uppercase;color:var(--text3);">Nome</div>
<div style="font-size:9px;font-weight:700;letter-spacing:.5px;text-transform:uppercase;color:var(--text3);">Tipo</div>
<div style="font-size:9px;font-weight:700;letter-spacing:.5px;text-transform:uppercase;color:var(--text3);text-align:center;">CA</div>
<div style="font-size:9px;font-weight:700;letter-spacing:.5px;text-transform:uppercase;color:var(--text3);text-align:center;">Max Des</div>
<div style="font-size:9px;font-weight:700;letter-spacing:.5px;text-transform:uppercase;color:var(--text3);text-align:center;">Peso kg</div>
<div style="font-size:9px;font-weight:700;letter-spacing:.5px;text-transform:uppercase;color:var(--text3);text-align:center;">‚ú¶</div>
<div></div>
</div>
<div id="armorItemsContainer"></div>
<button class="add-btn" onclick="addArmorItem()">+ Aggiungi Armatura / Scudo</button>
</div>

<!-- GIOIELLI & OGGETTI MAGICI -->
<div class="card">
<div class="card-title">Gioielli & Oggetti Magici (Bonus)</div>
<div id="jewelsContainer"></div>
<button class="add-btn" onclick="addJewelItem()">+ Aggiungi Gioiello / Oggetto Magico</button>
</div>

<!-- RIEPILOGO BONUS ATTIVI -->
<div class="card" id="bonusSummaryCard" style="display:none;">
<div class="card-title">Riepilogo Bonus Attivi</div>
<div id="bonusSummaryContent"></div>
</div>

</div>

<div class="tab-pane" id="tp5">
<div class="card">
<div class="grid3">
<div>
<div class="lbl">Classe Incant.</div>
<input id="spellClass" class="input mt6" placeholder="es. Mago">
</div>
<div>
<div class="lbl">Caratteristica</div>
<select id="spellAttr" class="input mt6" onchange="updateAll()" style="font-weight:700;color:var(--accent2);">
<option value="INT">INT</option>
<option value="WIS">SAG</option>
<option value="CHA">CAR</option>
</select>
</div>
<div class="centered">
<div class="lbl">Inc. Preparati</div>
<input id="spellPrepared" class="input mt6" type="number" value="0" style="text-align:center;font-weight:800;font-size:18px;color:var(--accent2);">
</div>
</div>
<div class="sep"></div>
<div class="grid3">
<div class="centered">
<div class="lbl">CD Tiro Salv.</div>
<div class="val-lg mt6" id="spellDC" style="color:var(--accent2);">13</div>
</div>
<div class="centered">
<div class="lbl">Bonus Attacco</div>
<div class="val-lg mt6" id="spellAtk" style="color:var(--accent2);">+3</div>
</div>
<div>
<div class="lbl">Punti Stregon. (us/max)</div>
<div style="display:flex;align-items:center;gap:5px;margin-top:6px;">
<input id="sorcUsed" class="input" type="number" value="0" style="text-align:center;font-weight:700;">
<span style="color:var(--text3);font-weight:700;">/</span>
<input id="sorcMax" class="input" type="number" value="0" style="text-align:center;font-weight:700;">
</div>
</div>
</div>
</div>
<div class="card">
<div class="card-title">Slot Incantesimo</div>
<div id="slotContainer"></div>
</div>
<div class="card">
<div class="card-title">Trucchetti (0¬∞ Livello)</div>
<div id="cantripContainer"></div>
<button class="add-btn" onclick="addSpell(0)">+ Aggiungi Trucchetto</button>
</div>
<div class="card">
<div class="card-title">Incantesimi per Livello</div>
<div class="lv-tabs" id="lvTabs"></div>
<div id="spellContent"></div>
<button class="add-btn" onclick="addSpell(curSpellLv)">+ Aggiungi Incantesimo</button>
</div>
</div>
<div class="tab-pane" id="tp6">
<div class="card">
<div class="card-title">Monete</div>
<div class="coins-row">
<div class="coin-box c-mp"><div class="coin-lbl">MP</div><input class="coin-inp" id="coinMP" type="number" value="0" min="0"></div>
<div class="coin-box c-mo"><div class="coin-lbl">MO</div><input class="coin-inp" id="coinMO" type="number" value="0" min="0"></div>
<div class="coin-box c-me"><div class="coin-lbl">ME</div><input class="coin-inp" id="coinME" type="number" value="0" min="0"></div>
<div class="coin-box c-ma"><div class="coin-lbl">MA</div><input class="coin-inp" id="coinMA" type="number" value="0" min="0"></div>
<div class="coin-box c-mr"><div class="coin-lbl">MR</div><input class="coin-inp" id="coinMR" type="number" value="0" min="0"></div>
</div>
<div style="text-align:center;font-size:10px;color:var(--text3);margin-top:8px;">1mp=10mo ¬∑ 1mo=2me ¬∑ 1me=5ma ¬∑ 1ma=10mr ¬∑ 100 monete=1kg</div>
</div>
<div class="card">
<div class="card-title">Carico & Ingombro</div>
<div class="carico-grid" id="caricoGrid"></div>
<div style="font-size:10px;color:var(--text3);text-align:center;margin-top:8px;">Valori per taglia media ¬∑ FOR√ó2,5 / √ó5 / √ó7,5 / √ó15 kg</div>
</div>
<div class="card">
<div style="display:flex;align-items:center;gap:8px;margin-bottom:12px;">
<div class="card-title" style="margin:0;flex:1;">Equipaggiamento</div>
<span style="font-size:10px;color:var(--text3);">I=Indosso ¬∑ Z=Zaino ¬∑ T=Tasca</span>
</div>
<div class="grid3 mb-8">
<div><div class="lbl">Zaino max (kg)</div><input id="zainoMax" class="input mt6" type="number" value="20" style="text-align:center;"></div>
<div><div class="lbl">Tasche n.</div><input id="tascaN" class="input mt6" type="number" value="1" style="text-align:center;"></div>
<div><div class="lbl">Tasca max (kg)</div><input id="tascaMax" class="input mt6" type="number" value="2" style="text-align:center;"></div>
</div>
<div style="display:grid;grid-template-columns:30px 1fr 38px 44px 44px 24px;gap:5px;padding:0 0 6px;margin-top:10px;">
<div class="w-hdr">LOC</div><div class="w-hdr">OGGETTO</div>
<div class="w-hdr" style="text-align:center;">QNT</div>
<div class="w-hdr" style="text-align:center;">KG/U</div>
<div class="w-hdr" style="text-align:center;">TOT</div><div></div>
</div>
<div id="inventoryContainer"></div>
<button class="add-btn" onclick="addItem()">+ Aggiungi Oggetto</button>
<div style="text-align:right;margin-top:8px;font-size:12px;font-weight:600;color:var(--text3);">
Peso tot: <span id="totalWeight" style="color:var(--text);">0.0</span> kg
</div>
</div>
<div class="card">
<div class="card-title">Gemme & Valori</div>
<textarea id="gemsNotes" class="input" placeholder="Gemme, gioielli, oggetti di valore‚Ä¶"></textarea>
<div class="mt10"><div class="lbl">Valori Prestati / Depositati</div>
<textarea id="depositsNotes" class="input mt6" placeholder="Dove ¬∑ Quanto ¬∑ Quando‚Ä¶"></textarea></div>
</div>
<div class="card">
<div class="card-title">Cavalcatura</div>
<div class="grid2">
<div><div class="lbl">Nome / Tipo</div><input id="mountName" class="input mt6" placeholder="es. Cavallo da guerra"></div>
<div><div class="lbl">Velocit√† (mt)</div><input id="mountSpeed" class="input mt6" type="number" value="0" style="text-align:center;"></div>
</div>
<div class="mt10"><div class="lbl">Note</div><textarea id="mountNotes" class="input mt6" style="min-height:50px;"></textarea></div>
</div>
</div>
<div class="tab-pane" id="tp7">
<div class="card">
<div class="card-title">Dati Personaggio</div>
<div class="grid2">
<div><div class="lbl">Data creazione</div><input id="dpCreated" class="input mt6" placeholder="gg/mm/aaaa"></div>
<div><div class="lbl">Data & Luogo di nascita</div><input id="dpBorn" class="input mt6"></div>
<div><div class="lbl">Divinit√† e Dominio</div><input id="dpGod" class="input mt6"></div>
<div></div>
</div>
<div class="grid3 mt10">
<div><div class="lbl">Et√†</div><input id="dpAge" class="input mt6"></div>
<div><div class="lbl">Sesso</div><input id="dpSex" class="input mt6"></div>
<div><div class="lbl">Taglia</div><input id="dpSize" class="input mt6" value="Media"></div>
<div><div class="lbl">Altezza</div><input id="dpHeight" class="input mt6"></div>
<div><div class="lbl">Peso</div><input id="dpWeight" class="input mt6"></div>
</div>
<div class="grid3 mt10">
<div><div class="lbl">Capelli</div><input id="dpHair" class="input mt6"></div>
<div><div class="lbl">Occhi</div><input id="dpEyes" class="input mt6"></div>
<div><div class="lbl">Carnagione</div><input id="dpSkin" class="input mt6"></div>
</div>
<div class="mt10"><div class="lbl">Modi di fare & Aspetto</div><textarea id="dpAppearance" class="input mt6"></textarea></div>
</div>
<div class="card">
<div class="card-title">Tratti & Personalit√†</div>
<div class="mt6"><div class="lbl">Tratti Caratteriali</div><textarea id="bgTraits" class="input mt6" placeholder="Come si comporta il tuo personaggio?"></textarea></div>
<div class="mt10"><div class="lbl">Ideali</div><textarea id="bgIdeals" class="input mt6" placeholder="Cosa guida le sue azioni?"></textarea></div>
<div class="mt10"><div class="lbl">Legami</div><textarea id="bgBonds" class="input mt6" placeholder="Cosa o chi √® pi√π importante per lui?"></textarea></div>
<div class="mt10"><div class="lbl">Difetti</div><textarea id="bgFlaws" class="input mt6" placeholder="Qual √® il suo tallone d'Achille?"></textarea></div>
</div>
<div class="card">
<div class="card-title">Storia & Alleanze</div>
<div class="mt6"><div class="lbl">Compagni & Alleati</div><textarea id="bgAllies" class="input mt6"></textarea></div>
<div class="mt10"><div class="lbl">Nemici</div><textarea id="bgEnemies" class="input mt6"></textarea></div>
<div class="mt10"><div class="lbl">Background & Note</div><textarea id="bgNotes" class="input mt6" style="min-height:120px;" placeholder="La storia del personaggio‚Ä¶"></textarea></div>
</div>
<div class="card">
<div class="card-title">Competenze</div>
<div class="mb-6"><div class="lbl">Armature</div>
<div class="comp-row mt6" id="armorComp"></div></div>
<div class="mt10"><div class="lbl">Armi</div>
<div class="comp-row mt6" id="weaponComp"></div></div>
<div class="mt10"><div class="lbl">Strumenti</div><textarea id="toolComp" class="input mt6" style="min-height:55px;" placeholder="Strumenti‚Ä¶"></textarea></div>
<div class="mt10"><div class="lbl">Linguaggi</div><textarea id="languages" class="input mt6" style="min-height:55px;" placeholder="Lingue conosciute‚Ä¶"></textarea></div>
</div>
<div class="card">
<div class="card-title">Classe, Razza & Talenti</div>
<div class="mt6"><div class="lbl">Privilegi di Classe</div><textarea id="classPriv" class="input mt6" style="min-height:90px;"></textarea></div>
<div class="mt10"><div class="lbl">Tratti Razziali</div><textarea id="racialTraits" class="input mt6" style="min-height:70px;"></textarea></div>
<div class="mt10"><div class="lbl">Talenti</div><textarea id="talentsText" class="input mt6" style="min-height:70px;"></textarea></div>
</div>
</div>
</div>
<div class="tab-bar">
<div class="tab-item active" onclick="goTab(1,this)" id="tab1">
<div class="tab-icon">
<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round">
<path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
<circle cx="12" cy="7" r="4"/>
</svg>
</div>
<div class="tab-label">Pers.</div>
</div>
<div class="tab-item" onclick="goTab(2,this)" id="tab2">
<div class="tab-icon">
<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round">
<line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/>
<line x1="3" y1="6" x2="3.01" y2="6"/><line x1="3" y1="12" x2="3.01" y2="12"/><line x1="3" y1="18" x2="3.01" y2="18"/>
</svg>
</div>
<div class="tab-label">Abilit√†</div>
</div>
<div class="tab-item" onclick="goTab(3,this)" id="tab3">
<div class="tab-icon">
<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round">
<path d="M14.5 17.5L3 6V3h3l11.5 11.5"/>
<path d="M13 19l6-6"/><path d="M2 2l20 20"/>
<path d="M20 9l-5-5"/><path d="M9 20l-5-5"/>
</svg>
</div>
<div class="tab-label">Combatt.</div>
</div>
<div class="tab-item" onclick="goTab(4,this)" id="tab4">
<div class="tab-icon">
<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round">
<path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
<path d="M9 12l2 2 4-4"/>
</svg>
</div>
<div class="tab-label">Armature</div>
</div>
<div class="tab-item" onclick="goTab(5,this)" id="tab5">
<div class="tab-icon">
<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round">
<polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
</svg>
</div>
<div class="tab-label">Magia</div>
</div>
<div class="tab-item" onclick="goTab(6,this)" id="tab6">
<div class="tab-icon">
<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round">
<path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"/>
<line x1="3" y1="6" x2="21" y2="6"/>
<path d="M16 10a4 4 0 0 1-8 0"/>
</svg>
</div>
<div class="tab-label">Zaino</div>
</div>
<div class="tab-item" onclick="goTab(7,this)" id="tab7">
<div class="tab-icon">
<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round">
<path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/>
<path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/>
</svg>
</div>
<div class="tab-label">Bg</div>
</div>
</div>
<div class="rest-buttons" id="restButtons">
<button class="rest-btn short-rest-btn" onclick="openRestModal('short')" title="Riposo Breve">
<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
<path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
<circle cx="9" cy="7" r="4"/>
<path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
<path d="M16 3.13a4 4 0 0 1 0 7.75"/>
</svg>
<span>Riposo<br>Breve</span>
</button>
<button class="rest-btn long-rest-btn" onclick="openRestModal('long')" title="Riposo Lungo">
<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
<path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
</svg>
<span>Riposo<br>Lungo</span>
</button>
</div>
<div class="rest-modal" id="restModal" onclick="if(event.target===this)closeRestModal()">
<div class="rest-sheet" id="restSheet">
<div class="dice-handle"></div>
<div id="restModalContent"></div>
</div>
</div>
<button class="save-fab" id="saveFab" onclick="saveAll()" title="Salva (tieni premuto per gestire personaggi)" oncontextmenu="openSaveManager();return false;">üíæ</button>
<button class="chars-fab" id="charsFab" onclick="openSaveManager()" title="Gestisci personaggi">
<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
<path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
<circle cx="9" cy="7" r="4"/>
<path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
<path d="M16 3.13a4 4 0 0 1 0 7.75"/>
</svg>
</button>
<div class="dice-toast" id="diceToast">
<div class="dice-num" id="diceNum">‚Äî</div>
<div class="dice-info" id="diceInfo">‚Äî</div>
</div>
<div class="dice-modal" id="diceModal" onclick="if(event.target===this)closeDice()">
<div class="dice-sheet">
<div class="dice-handle"></div>
<div style="font-size:12px;font-weight:700;letter-spacing:0.8px;color:var(--text3);margin-bottom:14px;text-align:center;">TIRA UN DADO</div>
<div class="dice-grid">
<button class="dice-btn" onclick="quickRoll(4,'d4')">d4</button>
<button class="dice-btn" onclick="quickRoll(6,'d6')">d6</button>
<button class="dice-btn" onclick="quickRoll(8,'d8')">d8</button>
<button class="dice-btn" onclick="quickRoll(10,'d10')">d10</button>
<button class="dice-btn" onclick="quickRoll(12,'d12')">d12</button>
<button class="dice-btn" onclick="quickRoll(20,'d20')">d20</button>
<button class="dice-btn" onclick="quickRoll(100,'d100')">d100</button>
<button class="dice-btn" onclick="closeDice()" style="color:var(--text3);">‚úï</button>
</div>
</div>
</div>

<!-- ‚ïê‚ïê‚ïê SCRIPTS ‚ïê‚ïê‚ïê -->
<!-- Data: razze, classi, sottoclassi -->
<script src="js/data.js"></script>
<!-- Core app logic -->
<script src="js/app.js"></script>
<!-- Armor & Jewels -->
<script src="js/armor.js"></script>
<!-- Rest system -->
<script src="js/rest.js"></script>
<!-- Save system -->
<script src="js/save.js"></script>
<!-- Char builder (race/class/level dropdowns) -->
<script src="js/builder.js"></script>
<!-- Init -->
<script>
// Register Service Worker (PWA offline support)
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('sw.js')
      .then(reg => {
        // Check for updates
        reg.addEventListener('updatefound', () => {
          const newSW = reg.installing;
          newSW.addEventListener('statechange', () => {
            if (newSW.state === 'installed' && navigator.serviceWorker.controller) {
              showUpdateBanner();
            }
          });
        });
      })
      .catch(err => console.log('SW error:', err));
  });
}

function showUpdateBanner() {
  const b = document.getElementById('updateBanner');
  if (b) b.classList.add('show');
}

// Install banner logic
(function(){
  function adjustOffset(){
    const b = document.getElementById('saveBanner');
    if (!b || b.classList.contains('hidden')) return;
    const h = b.offsetHeight;
    const hdr = document.querySelector('.app-header');
    if (hdr) hdr.style.marginTop = h + 'px';
  }
  setTimeout(adjustOffset, 120);
  window.addEventListener('resize', adjustOffset);

  window.hideBanner = function() {
    const b = document.getElementById('saveBanner');
    if (!b) return;
    b.classList.add('hidden');
    const hdr = document.querySelector('.app-header');
    if (hdr) hdr.style.marginTop = '0';
    setTimeout(() => b.remove(), 500);
    try { localStorage.setItem('dnd_banner_dismissed', '1'); } catch(e) {}
  };

  try {
    if (localStorage.getItem('dnd_banner_dismissed') === '1') {
      const b = document.getElementById('saveBanner');
      if (b) b.classList.add('hidden');
    }
  } catch(e) {}
})();

// Boot
buildCharBuilderUI();
</script>

<!-- Update notification banner -->
<div id="updateBanner">
  <span>üîÑ Nuova versione disponibile!</span>
  <button onclick="window.location.reload()">Aggiorna</button>
</div>
</body>
</html>